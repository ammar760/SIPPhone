<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SIP Phone</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com" />
</head>
<body>
  <div class="app-container">
    <!-- Phone Panel -->
    <div class="phone-panel">
      <div class="phone-header">
        <div class="status-bar">
          <div class="status-indicator" id="statusIndicator">
            <span class="status-dot"></span>
            <span class="status-text" id="statusText">Disconnected</span>
          </div>
          <div class="account-info">
            <span id="accountDisplay">19544818620</span>
          </div>
        </div>
      </div>

      <!-- Call Display -->
      <div class="call-display">
        <div class="call-info" id="callInfo" style="display:none;">
          <div class="call-status" id="callStatus">Calling...</div>
          <div class="call-duration" id="callDuration">00:00</div>
          <div class="call-remote" id="callRemote"></div>
        </div>
        <div class="dial-input-wrapper">
          <input type="text" id="dialInput" class="dial-input" placeholder="Enter number..." autocomplete="off" />
          <button class="btn-backspace" id="btnBackspace" title="Backspace">
            <i class="fas fa-delete-left"></i>
          </button>
        </div>
      </div>

      <!-- Dialpad -->
      <div class="dialpad">
        <button class="dial-btn" data-digit="1"><span class="digit">1</span><span class="sub">&nbsp;</span></button>
        <button class="dial-btn" data-digit="2"><span class="digit">2</span><span class="sub">ABC</span></button>
        <button class="dial-btn" data-digit="3"><span class="digit">3</span><span class="sub">DEF</span></button>
        <button class="dial-btn" data-digit="4"><span class="digit">4</span><span class="sub">GHI</span></button>
        <button class="dial-btn" data-digit="5"><span class="digit">5</span><span class="sub">JKL</span></button>
        <button class="dial-btn" data-digit="6"><span class="digit">6</span><span class="sub">MNO</span></button>
        <button class="dial-btn" data-digit="7"><span class="digit">7</span><span class="sub">PQRS</span></button>
        <button class="dial-btn" data-digit="8"><span class="digit">8</span><span class="sub">TUV</span></button>
        <button class="dial-btn" data-digit="9"><span class="digit">9</span><span class="sub">WXYZ</span></button>
        <button class="dial-btn" data-digit="*"><span class="digit">*</span><span class="sub">&nbsp;</span></button>
        <button class="dial-btn" data-digit="0"><span class="digit">0</span><span class="sub">+</span></button>
        <button class="dial-btn" data-digit="#"><span class="digit">#</span><span class="sub">&nbsp;</span></button>
      </div>

      <!-- Call Actions -->
      <div class="call-actions">
        <button class="action-btn btn-call" id="btnCall" title="Call">
          <i class="fas fa-phone"></i>
        </button>
        <button class="action-btn btn-hangup" id="btnHangup" title="Hang Up" style="display:none;">
          <i class="fas fa-phone-slash"></i>
        </button>
        <button class="action-btn btn-answer" id="btnAnswer" title="Answer" style="display:none;">
          <i class="fas fa-phone-flip"></i>
        </button>
      </div>

      <!-- In-call Controls -->
      <div class="incall-controls" id="incallControls" style="display:none;">
        <button class="ctrl-btn" id="btnMute" title="Mute">
          <i class="fas fa-microphone"></i>
          <span>Mute</span>
        </button>
        <button class="ctrl-btn" id="btnHold" title="Hold">
          <i class="fas fa-pause"></i>
          <span>Hold</span>
        </button>
        <button class="ctrl-btn" id="btnTransfer" title="Transfer">
          <i class="fas fa-right-left"></i>
          <span>Transfer</span>
        </button>
        <button class="ctrl-btn" id="btnDtmf" title="DTMF">
          <i class="fas fa-hashtag"></i>
          <span>DTMF</span>
        </button>
      </div>

      <!-- Settings toggle -->
      <div class="phone-footer">
        <button class="footer-btn" id="btnSettings" title="Settings">
          <i class="fas fa-gear"></i>
        </button>
        <button class="footer-btn" id="btnRegister" title="Register/Connect">
          <i class="fas fa-plug"></i> Connect
        </button>
        <button class="footer-btn" id="btnUnregister" title="Unregister" style="display:none;">
          <i class="fas fa-plug-circle-xmark"></i> Disconnect
        </button>
      </div>

      <!-- Settings Panel -->
      <div class="settings-panel" id="settingsPanel" style="display:none;">
        <h3>SIP Configuration</h3>
        <div class="form-group">
          <label for="sipServer">SIP Server</label>
          <input type="text" id="sipServer" value="pbx.catalectconsulting.com" />
        </div>
        <div class="form-group">
          <label for="sipPort">Port</label>
          <input type="text" id="sipPort" value="5060" />
        </div>
        <div class="form-group">
          <label for="sipTransport">Transport</label>
          <select id="sipTransport" style="width:100%;background:var(--bg-input);border:1px solid var(--border);border-radius:6px;color:var(--text);padding:10px 12px;font-size:13px;">
            <option value="udp">UDP</option>
            <option value="tcp">TCP</option>
            <option value="tls" selected>TLS (recommended)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="sipExtension">Extension / Username</label>
          <input type="text" id="sipExtension" value="19544818620" />
        </div>
        <div class="form-group">
          <label for="sipPassword">Password</label>
          <input type="password" id="sipPassword" value="326976df3213d2ad06a16da6f607f926" />
        </div>
        <div class="form-group">
          <label for="sipDisplayName">Display Name</label>
          <input type="text" id="sipDisplayName" value="SIP Phone" />
        </div>
        <div class="form-actions">
          <button class="btn-save" id="btnSaveSettings">Save & Close</button>
        </div>
      </div>
    </div>

    <!-- Logs Panel -->
    <div class="logs-panel">
      <div class="logs-header">
        <h3><i class="fas fa-list-check"></i> Call & SIP Logs</h3>
        <div class="logs-toolbar">
          <div class="log-filters">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="sip">SIP</button>
            <button class="filter-btn" data-filter="call">Calls</button>
            <button class="filter-btn" data-filter="error">Errors</button>
          </div>
          <button class="btn-clear-logs" id="btnClearLogs" title="Clear Logs">
            <i class="fas fa-trash"></i>
          </button>
          <button class="btn-export-logs" id="btnExportLogs" title="Export Logs">
            <i class="fas fa-download"></i>
          </button>
        </div>
      </div>
      <div class="logs-body" id="logsBody">
        <div class="log-entry log-info">
          <span class="log-time">--:--:--</span>
          <span class="log-badge badge-info">INFO</span>
          <span class="log-message">SIP Phone ready. Configure settings and click Connect.</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts â€” no external SIP/WS libraries needed, SIP runs in Electron main process over raw UDP -->
  <script src="js/logger.js"></script>
  <script src="js/phone.js"></script>
</body>
</html>
